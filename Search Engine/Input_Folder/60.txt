https://towardsdatascience.com/the-gaussian-model-4a94a2b3ff1b?source=collection_category---4------0-----------------------
The Gaussian Model - Towards Data Science Sign in Data Science Machine Learning Programming Visualization AI Video About Contribute Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov. The Gaussian Model A back-of-the-envelope sketch of COVID-19 infections. James Hetrick Follow Mar 25 · 7 min read Photo by author Disclaimer first: I’m not an epidemiologist. These are not professional projections; these are back-of-the-envelope calculations. I’m a physicist, and you know how we love our “orders of magnitude”, “spherical cow approximations”, and “back-of-envelope calculations”. The New York Times this past week had an article about which countries are “flattening the curve”, so let’s explore a simple model of these “curves”. Daily COVID-19 infection rates for selected countries A back-of-the-envelope model of infection rate data Of course, we’ll use the simplest model: the Normal or Gaussian curve. The Normal, or Gaussian curve The infections start out growing exponentially at first, then whatever response the host country enacts, after some time, new infections go back to near zero. At least that’s the back-of-the-envelope theory. Surely there are better models, but we’ll use the Gaussian model as a first shot. The Gaussian model is defined by only three parameters: N, ?, and ?, and looks like this: N is the infection rate at its peak, the midpoint of the epidemic. ? is the date of the peak infection rate, and ? controls the width, the period of time the pandemic is experienced by the country. Gaussian Model Parameters In this model, at 2? days before peak infection, on day ?-2? (day 20), about 2% of the total people have been infected. By 1? days before peak (day 35), roughly 16% of the total final infected population are already positive. On day ?, 50% of total cases are infected. On a given day, the area fraction under the curve = the cumulative number of cases divided by the total number of cases at the end of the epidemic. Using the model Let’s first try the model on countries which seem to be past peak infection and are on their way to recovery: China and South Korea. We can get data in the format we need from the European Center for Disease Prevention and Control, the EU equivalent of the US CDC. Kaggle also has good data. Plotting the daily infection rate from China, starting on Jan 1, 2020, shows the large spike in cases around day 43 (Feb 12) when medical teams started to use simpler and faster methods of diagnosis versus the earlier DNA matching tests. Even so, the Gaussian model provides a decent fit. For South Korea, the fit perhaps looks better. But it’s not capturing the stalled falloff on the right side very well. It could even be that this excess represents a separate regional Gaussian event. To fit the model to these data, I used the curve_fit() function from the python scipy.optimize module and my Jupyter notebook is here. One simple check on these models is whether the total area under the model curve is anywhere close to the actual total infections for the country. Standard procedure for back-of-the-envelope calculations is frequent sanity checks. Given N and ?, the total area under the model curve is: Here are the comparisons (as of Mar 24, 2020) China Actual total cases: 81748 Model total area: 79315 surprisingly, only about 3% off. South Korea Actual total cases: 9037 Model total area: 8145 ?10% off, mainly because the model is missing that recent stall in the drop in cases in South Korea. But, 10% is not that bad for a back-of-the-envelope estimate. Predictive modeling Here’s where the back-of-the-envelope model fails, or rather looses its ?10% goodness. Below are the Gaussian model fits to the data as of writing (Mar 24, 2020) for a few countries. We can get a sense of “how far into it” the country is at the current moment, by comparing the current cumulative number infected to the expected total cases from the model. This ratio is the area under the model so far, divided by total area of the model. This percentage is shown below the figures (area fractions greater than 100% are possible since the total number of actual cases can differ from the total predicted by the model, e.g. South Korea). Keep in mind that the area fraction is an estimate from the model, and thus is subject to statistical suspicions of the model that will be raised below. Gaussian model fits to various country’s new daily infection rates and World data (excluding China). Below each graph is the “area fraction”, an estimate of “how far into it” that country is. Problems with this simple model There are so many ways that this model is too simple! Real epidemiological models incorporate things like Markov Chain Monte Carlo (MCMC), coupled differential equations, real-time transportation data, and social graph analysis. As you can see by experimenting with games like Plague Inc. on your phone, there are many ways the epidemic can take on a life of its own and deviate from simple models. Really — the only thing the Gaussian model has going for it is the Central Limit Theorem, and that it’s back-of-the-envelope simple. The model captures gross features reasonably well after the event for countries which seem to now have the infections under control, such as China and South Korea (and something non-gaussian seems to be happening now in South Korea, as mentioned above). But the fit parameters, ?, N, and ?, of the model depend very much on where you are along the curve, i.e. your area fraction. As you climb one side of the data, there are many local peaks and valleys. But, if your country is already close to halfway through the infection curve, you can make a pretty good guess about the future using the Gaussian model. From the perspective at the peak, when the area fraction = 50%, the future should look, well, sort of like the past in reverse. Infections should start to lessen, and finally dwindle to zero. The problem is, you don’t know for sure when you are there. If you are only, say, 10% through the exponential uptick of infections, then the error bars on the parameters you get using the Gaussian model are far too sensitive to the latest data. Below are some of the different possible models that we get from statistical fluctuations of the data at 10%, 20%, and 30% of the way through pandemic (area fraction). You can see that the models fluctuate wildly when we only have data far to the left of the center peak, at a small area fraction. Model parameter variance when fit at different area fractions In fact the variance of the Gaussian model’s ? parameter, as estimated at different points “into the event” (represented by the area fraction under the curve at that point), blows up as we move earlier to the left. Thus, we can’t really use this simple approximation as a predictive model, at least until we are well into the thick of it, with maybe 30% of total infections already known. And again, we don’t really know when that is until afterward. For example, the current area fraction estimate from the US data is ?15%. This means there is a lot of variance in the possible models we get using the data to date (Mar 24, 2020). Here are some examples, including the “best” fit: N=21178, ?=91 (March 31st!), and ?=6, as returned by the curve_fit() function. This seems ridiculously optimistic, despite calls from various leaders to get “back to work”. But other model parameters that match the US data similarly well at this moment (day 85) are not so encouraging, and look like this. Some possible Gaussian models of infection rate, matching current US data (Mar 24, 2020). At this area fraction (15%) the variance in possible models is very large. Looking at the longer term side of these models shows how little we really know at this point. Note that even the “area fraction” estimate (15% for the US) has very large modeling error, as can be seen below. While we seem to be 15% of the way through the optimistic (blue) model, we are less than 1% of our way through the other “reasonable” models (red, green, and orange). It’s just too early to tell. Longer term view of possible models using current (Mar 24, 2020) US data. Still this back-of the-envelope model is instructive to play with. It’s very simple, and each week more data comes in, moving us further along the curve so that the Gaussian model has a bit more predictive power. It’s interesting to see that Iran and Italy seem to be near or nearing the peak. The model also points out how bad unsophisticated predictions are at this stage of the epidemic, and does seem to show that we may have a way to go before we are at something like a comfortable 90% area fraction. Note that South Korea has a 111% area fraction and their infections are still not trailing off, so don’t mistake this for real epidemiological modeling. It’s just the musings of someone with easy access to data, suddenly lots of time at home, and a stack of envelopes piling up. Towards Data Science A Medium publication sharing concepts, ideas, and codes. Follow 64 Towards Data Science Coronavirus Covid 19 64 claps Written by James Hetrick Follow Dr. James Hetrick is a Professor of Physics and the Associate Director of the Master’s degree program in Data Science at the University of the Pacific. Follow Towards Data Science Follow A Medium publication sharing concepts, ideas, and codes. Follow Write the first response Discover MediumWelcome to a place where words matter. On Medium, smart voices and original ideas take center stage - with no ads in sight. Watch Make Medium yoursFollow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox. Explore Become a memberGet unlimited access to the best stories on Medium — and support writers while you’re at it. Just $5/month. Upgrade AboutHelpLegal
